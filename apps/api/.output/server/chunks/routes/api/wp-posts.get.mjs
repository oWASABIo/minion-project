import{d as t,m as s,l as e}from"../../nitro/nitro.mjs";const r=t(async t=>{const r=s(t),a=String(r.baseUrl||"").trim(),o=String(r.restBase||"/wp-json/wp/v2").trim(),n=String(r.endpoint||"").trim();if(!a||!n)throw e({statusCode:400,statusMessage:"baseUrl and endpoint are required"});try{!function(t){const s=new URL(t);if(!/^https?:$/.test(s.protocol))throw new Error("Invalid protocol");if(function(t){const s=t.toLowerCase();return"localhost"===s||"127.0.0.1"===s||"::1"===s||s.endsWith(".local")}(s.hostname))throw new Error("Private host not allowed")}(a)}catch(t){throw e({statusCode:400,statusMessage:(null==t?void 0:t.message)||"Invalid baseUrl"})}const i=function(t,s,e){const r=t.replace(/\/$/,""),a=(e||"").trim(),o=(s||"").trim();if(!r||!a)return"";if(/^https?:\/\//i.test(a))return a;if(a.startsWith("/wp-json/"))return`${r}${a}`;const n=o?o.replace(/\/$/,""):"",i=a.startsWith("/")?a:`/${a}`;return n?`${r}${n}${i}`:`${r}${i}`}(a,o,n);if(!i)throw e({statusCode:400,statusMessage:"Invalid WP url"});const c=await fetch(i,{headers:{Accept:"application/json","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"}});if(!c.ok){const t=await c.text().catch(()=>"");throw e({statusCode:c.status,statusMessage:`WP request failed: ${c.status}`,data:t})}return await c.json()});export{r as default};
//# sourceMappingURL=wp-posts.get.mjs.map
